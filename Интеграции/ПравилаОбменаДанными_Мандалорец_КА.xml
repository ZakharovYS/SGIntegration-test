<ПравилаОбмена>
	<ВерсияФормата РежимСовместимости="РежимСовместимостиСБСП20">2.01</ВерсияФормата>
	<Ид>e2875b4d-97f5-4c87-bda5-82af68cd8a38    </Ид>
	<Наименование>УправлениеПроизводственнымПредприятием_Мандалорец --&gt; КомплекснаяАвтоматизация</Наименование>
	<ДатаВремяСоздания>2025-10-21T11:23:20</ДатаВремяСоздания>
	<Источник ВерсияПлатформы="8.0" ВерсияКонфигурации="1.3.3.1" СинонимКонфигурации="THE Mandalorian">УправлениеПроизводственнымПредприятием</Источник>
	<Приемник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.4.12.81" СинонимКонфигурации="1С:Комплексная автоматизация 2">КомплекснаяАвтоматизация</Приемник>
	<Параметры/>
	<Обработки/>
	<ПравилаКонвертацииОбъектов>
		<Группа>
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило>
				<Код>Номенклатура</Код>
				<Наименование>Справочник: Номенклатура</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>
	Если Источник.ЭтоДарко = Истина Тогда
		Отказ = Истина;
	Иначе
		Если Источник.ЭтоГруппа = Ложь Тогда
			
			//ВыгрузитьПоПравилу(Источник.ЕдиницаХраненияОстатков,,,,"УпаковкиЕдиницыИзмерения_1Уровень");  Паша 04.09.2020 Пока грузим без упаковки
			
			мВходящиеДанные = Новый Структура();
			мВходящиеДанные.Вставить("Номенклатура",Источник.Ссылка);
	
			Запрос = Новый Запрос();

			Запрос.Текст = "ВЫБРАТЬ ПЕРВЫЕ 1
	               |	Штрихкоды.Штрихкод
	               |ИЗ
	               |	РегистрСведений.Штрихкоды КАК Штрихкоды
	               |ГДЕ
	               |	Штрихкоды.ТипШтрихкода = &amp;ТипШтрихкода
	               |	И Штрихкоды.Владелец = &amp;Номенклатура";
				   
			Запрос.УстановитьПараметр("ТипШтрихкода",ПланыВидовХарактеристик.ТипыШтрихкодов.НайтиПоКоду("00000000008"));//Штрих код1

			Если ТипЗнч(Источник) = Тип("СправочникОбъект.Номенклатура") Тогда
				Запрос.УстановитьПараметр("Номенклатура",Источник.Ссылка);
			ИначеЕсли ТипЗнч(Источник) = Тип("СправочникСсылка.Номенклатура") Тогда
				Запрос.УстановитьПараметр("Номенклатура",Источник);
			Иначе
				Запрос.УстановитьПараметр("Номенклатура",Источник);	
			КонецЕсли;
	
			мВыборкаИзЗапроса = Запрос.Выполнить().Выбрать();

			Если мВыборкаИзЗапроса.Количество() = 1 Тогда
	
				Пока мВыборкаИзЗапроса.Следующий() Цикл
	
					мЗначение = мВыборкаИзЗапроса.Штрихкод;
					мВходящиеДанные.Вставить("Штрихкод",мЗначение);
					ВыгрузитьПоПравилу(,,мВходящиеДанные,,"ШтрихкодыНоменклатуры");
			
				КонецЦикла;
	
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;</ПередВыгрузкой>
				<ПослеЗагрузки>Выполнить(Алгоритмы.ПослеЗаписиНоменклатуры);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.Номенклатура</Источник>
				<Приемник>СправочникСсылка.Номенклатура</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>2</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Артикул --&gt; Артикул</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Артикул" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Артикул" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Номенклатура"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Номенклатура"/>
						<КодПравилаКонвертации>НоменклатураСозданиеКарточкиРодителя              </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>СтавкаНДС --&gt; СтавкаНДС</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
						<Приемник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
						<КодПравилаКонвертации>СтавкиНДС                                         </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>НоменклатураСозданиеКарточкиРодителя</Код>
				<Наименование>Справочник: Номенклатура</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>Если Источник.ЭтоДарко = Истина Тогда
		
	Отказ = Истина;
		
Иначе
		
КонецЕсли;</ПередВыгрузкой>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.Номенклатура</Источник>
				<Приемник>СправочникСсылка.Номенклатура</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>Артикул --&gt; Артикул</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Артикул" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Артикул" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Номенклатура"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Номенклатура"/>
						<КодПравилаКонвертации>НоменклатураСозданиеКарточкиРодителя              </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>6</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>НоменклатураТолькоСсылка</Код>
				<Наименование>Справочник: Номенклатура</Наименование>
				<Порядок>50</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Номенклатура</Источник>
				<Приемник>СправочникСсылка.Номенклатура</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>2</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Склады</Код>
				<Наименование>Справочник: Склады (места хранения)</Наименование>
				<Порядок>100</Порядок>
				<ПередВыгрузкой>// Захаров Закомментил проверку на дарко
//Отказ = Источник.ЭтоДарко;</ПередВыгрузкой>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.Склады</Источник>
				<Приемник>СправочникСсылка.Склады</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СкладыТолькоСсылка</Код>
				<Наименование>Справочник: Склады (места хранения)</Наименование>
				<Порядок>100</Порядок>
				<ПередВыгрузкой>Отказ = Источник.ЭтоДарко;</ПередВыгрузкой>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Склады</Источник>
				<Приемник>СправочникСсылка.Склады</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Регистры сведений</Код>
			<Наименование>Регистры сведений</Наименование>
			<Порядок>100</Порядок>
			<Правило>
				<Код>ШтрихкодыНоменклатуры</Код>
				<Наименование>: </Наименование>
				<Порядок>50</Порядок>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<Приемник>РегистрСведенийЗапись.ШтрихкодыНоменклатуры</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>--&gt; Штрихкод</Наименование>
						<Порядок>50</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Штрихкод" Вид="Измерение" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>--&gt; Номенклатура</Наименование>
						<Порядок>100</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Номенклатура" Вид="Ресурс" Тип="СправочникСсылка.Номенклатура"/>
						<КодПравилаКонвертации>НоменклатураСозданиеКарточкиРодителя              </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Перечисления</Код>
			<Наименование>Перечисления</Наименование>
			<Порядок>150</Порядок>
			<Правило>
				<Код>СтавкиНДС</Код>
				<Наименование>Перечисление: Ставки НДС</Наименование>
				<Порядок>50</Порядок>
				<Источник>ПеречислениеСсылка.СтавкиНДС</Источник>
				<Приемник>ПеречислениеСсылка.СтавкиНДС</Приемник>
				<Свойства/>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>БезНДС --&gt; БезНДС</Наименование>
						<Порядок>50</Порядок>
						<Источник>БезНДС</Источник>
						<Приемник>БезНДС</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>НДС0 --&gt; НДС0</Наименование>
						<Порядок>100</Порядок>
						<Источник>НДС0</Источник>
						<Приемник>НДС0</Приемник>
					</Значение>
					<Значение>
						<Код>3</Код>
						<Наименование>НДС10 --&gt; НДС10</Наименование>
						<Порядок>150</Порядок>
						<Источник>НДС10</Источник>
						<Приемник>НДС10</Приемник>
					</Значение>
					<Значение>
						<Код>4</Код>
						<Наименование>НДС10_110 --&gt; НДС10_110</Наименование>
						<Порядок>200</Порядок>
						<Источник>НДС10_110</Источник>
						<Приемник>НДС10_110</Приемник>
					</Значение>
					<Значение>
						<Код>5</Код>
						<Наименование>НДС18 --&gt; НДС18</Наименование>
						<Порядок>250</Порядок>
						<Источник>НДС18</Источник>
						<Приемник>НДС18</Приемник>
					</Значение>
					<Значение>
						<Код>6</Код>
						<Наименование>НДС18_118 --&gt; НДС18_118</Наименование>
						<Порядок>300</Порядок>
						<Источник>НДС18_118</Источник>
						<Приемник>НДС18_118</Приемник>
					</Значение>
					<Значение>
						<Код>7</Код>
						<Наименование>НДС20 --&gt; НДС20</Наименование>
						<Порядок>350</Порядок>
						<Источник>НДС20</Источник>
						<Приемник>НДС20</Приемник>
					</Значение>
					<Значение>
						<Код>8</Код>
						<Наименование>НДС20_120 --&gt; НДС20_120</Наименование>
						<Порядок>400</Порядок>
						<Источник>НДС20_120</Источник>
						<Приемник>НДС20_120</Приемник>
					</Значение>
				</Значения>
			</Правило>
		</Группа>
	</ПравилаКонвертацииОбъектов>
	<ПравилаВыгрузкиДанных>
		<Группа Отключить="false">
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило Отключить="false">
				<Код>Номенклатура</Код>
				<Наименование>Номенклатура</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Номенклатура</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>Склады</Код>
				<Наименование>Склады</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Склады</ОбъектВыборки>
			</Правило>
		</Группа>
	</ПравилаВыгрузкиДанных>
	<ПравилаОчисткиДанных/>
	<Алгоритмы>
		<Алгоритм Имя="ПослеЗаписиНоменклатуры" ИспользуетсяПриЗагрузке="true">
			<Текст>
Если Объект.ЭтоГруппа = Ложь Тогда
	
	Если ЗначениеЗаполнено(Объект.ВидНоменклатуры) = Ложь Тогда
		Объект.ВидНоменклатуры = Справочники.ВидыНоменклатуры.НайтиПоНаименованию("Сырьё");
		Справочники.Номенклатура.ЗаполнитьРеквизитыПоВидуНоменклатуры(Объект,,,Объект.ВидНоменклатуры);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.Качество) = Ложь Тогда
		Объект.Качество = Перечисления.ГрадацииКачества.Новый;	
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.ЕдиницаИзмерения) = Ложь Тогда
		Объект.ЕдиницаИзмерения = Справочники.УпаковкиЕдиницыИзмерения.НайтиПоКоду("166");	
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.ВариантОформленияПродажи) = Ложь Тогда
		Объект.ВариантОформленияПродажи = Перечисления.ВариантыОформленияПродажи.РеализацияТоваровУслуг;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.ИспользованиеХарактеристик) = Ложь Тогда
		Объект.ИспользованиеХарактеристик = Перечисления.ВариантыИспользованияХарактеристикНоменклатуры.НеИспользовать;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.ТипНоменклатуры) = Ложь Тогда
		Объект.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Товар;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Объект.ИспользоватьУпаковки) = Ложь Тогда
		Объект.ИспользоватьУпаковки = Ложь;
	КонецЕсли;
	
	//Если ЗначениеЗаполнено(Объект.Артикул) = Ложь Тогда
	//	Отказ = Истина;
	//КонецЕсли;
	
	////Если ОбъектНайден = Истина Тогда   // Статус ОбъектНайден тут не работает !!! 
	//	
	//КодБазовойЕдиницы = ПараметрыОбъекта.Получить("ЕдиницаПоКлассификаторуБазовая");
	//
	//Если КодБазовойЕдиницы = "821" Тогда    // 24.05.19 Паша в УПП длина кода 3 знака в УТ 5 знаков. Это просто лажа конечно, но по другому сейчас не сделать ((((
	//	КодБазовойЕдиницы = "8751";
	//ИначеЕсли КодБазовойЕдиницы = "778" Тогда // 27.05.19 Паша у нас кривые базовые единицы в УПП. Нужно захардкодить коды базовых единиц	
	//	КодБазовойЕдиницы = "778";	
	//ИначеЕсли КодБазовойЕдиницы = "166" Тогда
	//	КодБазовойЕдиницы = "166";
	//ИначеЕсли КодБазовойЕдиницы = "796" Тогда
	//	КодБазовойЕдиницы = "796";		
	//Иначе
	//	Отказ = Истина;
	//	Сообщить("Ошибка в единице номенклатура "+Строка(Объект));
	//КонецЕсли;
	//	
	//Объект.ЕдиницаИзмерения = Справочники.УпаковкиЕдиницыИзмерения.НайтиПоКоду(КодБазовойЕдиницы);	
	//
	//Объект.НаборУпаковок = Справочники.НаборыУпаковок.ИндивидуальныйДляНоменклатуры;
	
	Справочники.Номенклатура.ОтработатьЛогикуСвязиРеквизитов(Объект);
	
КонецЕсли;</Текст>
		</Алгоритм>
	</Алгоритмы>
	<Запросы/>
</ПравилаОбмена>